/*! 
 * rtMedia Favourites JavaScript Library 
 * @package rtMedia Favourites 
 */

function rtm_media_rate(a,b){if("1"==rt_user_logged_in){var c,d;void 0===jQuery("#rtm-media-rate-form").attr("action")?(c=rtmedia_ajax_url,d={value:a,action:"rtm_album_rating",media_id:b.media_id,nonce:jQuery("#"+b.el_id).data("nonce")}):(c=jQuery("#rtm-media-rate-form").attr("action"),d={value:a,nonce:jQuery("#"+b.el_id).data("nonce")});var e="<img class='rtm-rate-loading' src='"+rMedia_loading_file+"' />";rating_content_el=jQuery("#"+b.el_id).parent(".rtm-media-rate-star-wrapper").siblings(".rtmedia-pro-average-rating"),rating_content_html=rating_content_el.html(),rating_content_el.html(e),jQuery.post(c,d,function(c){c=JSON.parse(c),rating_content_el.html(rating_content_html);var d=jQuery("#"+b.el_id).parent().siblings(".rtmedia-pro-average-rating");d.find(".rtmedia_pro_media_average_rating").text(c.average.toFixed(0)),d.find(".rtmedia_pro_media_user_rating").text(a),"0"==c.curr_value?jQuery("#rtm-undo-rating-"+c.media_id).css("display","none"):jQuery("#rtm-undo-rating-"+c.media_id).css("display","inline-block")})}}function rtmedia_init_rating(){jQuery(".rtmedia_pro_rate_media").length&&jQuery(".rtmedia_pro_rate_media").each(function(a){0==jQuery(this).siblings(".webwidget_rating_simple").length&&(extra_args={media_id:jQuery(this).data("media-id"),el_id:jQuery(this).attr("id")},jQuery(this).webwidget_rating_simple({rating_star_length:"5",rating_initial_value:jQuery(this).val(),rating_function_name:"rtm_media_rate",rating_extra_args:extra_args}))})}jQuery(document).on("click",".rtm-undo-rating",function(){var a={media_id:jQuery(this).data("media-id"),el_id:jQuery(this).data("el-id")};if(rtm_media_rate(0,a),""!==a.el_id){var b=jQuery("#"+a.el_id);b.val(0),b.parent(".rtm-media-rate-star-wrapper").find("div").each(function(){jQuery(this).removeClass("dashicons-star-filled").addClass("dashicons-star-empty")}),b.next("ul").hover(function(){},function(){var a=$(this).children("li").children("div");a.removeClass("dashicons-star-filled"),a.addClass("dashicons-star-empty");var b=$(this).parent().children("input").val();a.slice(0,b).removeClass("dashicons-star-empty"),a.slice(0,b).addClass("dashicons-star-filled")})}}),jQuery(document).ready(function(a){rtmedia_init_rating(),function(){var a=jQuery(".rtmedia-container .rtmedia-list-item .rtmedia-item-thumbnail img"),b=jQuery(".rtmedia-container .rtmedia-list  .rtmedia-list-item"),c=a.height()+70;b.css("min-height",c+"px")}(),rtMediaHook.register("rtmedia_js_popup_after_content_added",function(a){return rtmedia_init_rating(),1}),rtMediaHook.register("rtmedia_after_gallery_load",function(a){return rtmedia_init_rating(),1})});